================================================================================
               DOCUMENTACI√ìN DEL SCRIPT - Corner.py
================================================================================

AUTOR: Script de Automatizaci√≥n WordPress
VERSI√ìN: 2.0
FECHA: 2025
SITIO WEB: https://cornergourmet.es

================================================================================
1. ¬øQU√â HACE ESTE SCRIPT?
================================================================================

Este script automatiza la publicaci√≥n de contenido en WordPress desde documentos
Word (.docx). Lee archivos Word con un formato espec√≠fico y crea autom√°ticamente
borradores de posts en WordPress con:

‚úì T√≠tulo del art√≠culo
‚úì Descripci√≥n con formato HTML (negritas, cursivas, listas)
‚úì Frase clave objetivo (SEO)
‚úì T√≠tulo SEO  
‚úì Meta descripci√≥n
‚úì Categor√≠as (crea las que no existan)

DIFERENCIA CLAVE:
-----------------
Este script est√° dise√±ado para WordPress con EDITOR GUTENBERG (bloques).
Si tu WordPress usa el editor cl√°sico, consulta la documentaci√≥n de EstarDeModa.py

================================================================================
2. REQUISITOS PREVIOS
================================================================================

INSTALACIONES NECESARIAS:
-------------------------
1. Python 3.9 o superior
2. Google Chrome (navegador)
3. M√≥dulos Python:
   - python-docx (para leer archivos Word)
   - selenium (para automatizar el navegador)

INSTALACI√ìN DE M√ìDULOS:
-----------------------
Ejecutar en la terminal:
    pip install python-docx selenium

================================================================================
3. CONFIGURACI√ìN DEL SCRIPT
================================================================================

UBICACI√ìN: L√≠neas 17-20 del script

PAR√ÅMETROS A CONFIGURAR:
------------------------
1. url_wp: URL del panel de administraci√≥n de WordPress
   Ejemplo: 'https://cornergourmet.es/wp-admin'

2. usuario_wp: Nombre de usuario de WordPress
   Ejemplo: 'admin5874'

3. password_wp: Contrase√±a de WordPress
   Ejemplo: 'tu_contrase√±a_aqu√≠'

4. carpeta_word: Ruta completa a la carpeta con archivos Word
   Ejemplo: r"C:\Users\Jonathan JD\Desktop\pink\Robert\CodigoCorner 1"

IMPORTANTE: Mant√©n estas credenciales seguras y no las compartas.

================================================================================
4. ESTRUCTURA DEL DOCUMENTO WORD
================================================================================

El documento Word DEBE tener la siguiente estructura:

FORMATO REQUERIDO:
------------------

Titulo de la ficha
[nombre del art√≠culo aqu√≠]

Descripci√≥n:
[contenido del art√≠culo con formato]
- Puedes usar negritas
- Puedes usar cursivas  
- Puedes crear listas
- Puedes usar subrayado

Frase clave objetivo
[palabra clave principal para SEO]

T√≠tulo SEO
[t√≠tulo optimizado para motores de b√∫squeda]

Meta description
[descripci√≥n breve de 150-160 caracteres]

Categor√≠as
[Categor√≠a 1, Categor√≠a 2, Categor√≠a 3]
(Separadas por comas)

NOTAS IMPORTANTES:
------------------
‚úì Los t√≠tulos de secci√≥n pueden estar con o sin tilde
‚úì Las categor√≠as se pueden separar por comas en una sola l√≠nea
‚úì Si una categor√≠a no existe, el script la crear√° autom√°ticamente
‚úì El formato (negritas, cursivas) se preserva autom√°ticamente
‚úì Las listas se convierten autom√°ticamente a HTML
‚úì El script NO maneja etiquetas (espec√≠fico de Corner)

================================================================================
5. ¬øC√ìMO FUNCIONA EL SCRIPT? - PASO A PASO
================================================================================

FASE 1: INICIALIZACI√ìN
----------------------
1. Lee todos los archivos .docx de la carpeta configurada
2. Ignora archivos temporales (que empiezan con ~$)
3. Muestra cu√°ntos archivos encontr√≥
4. Abre el navegador Chrome autom√°ticamente

FASE 2: LOGIN EN WORDPRESS
---------------------------
5. Navega a la p√°gina de login de WordPress
6. Introduce usuario y contrase√±a autom√°ticamente
7. Hace clic en el bot√≥n de login
8. Espera a que cargue el panel de administraci√≥n

FASE 3: PROCESAMIENTO DE CADA ARCHIVO (se repite para cada documento)
----------------------------------------------------------------------

3.1 LECTURA DEL DOCUMENTO:
   - Abre el archivo Word
   - Extrae el t√≠tulo (busca "Titulo de la ficha" y variaciones)
   - Extrae la descripci√≥n (busca "Descripci√≥n:" y su contenido)
   - Convierte el formato Word a HTML:
     * Negritas ‚Üí <strong>
     * Cursivas ‚Üí <em>
     * Subrayado ‚Üí <u>
     * Listas ‚Üí <ul><li>
   - Extrae frase clave objetivo
   - Extrae t√≠tulo SEO
   - Extrae meta descripci√≥n
   - Extrae categor√≠as (divide por comas si hay varias)

3.2 CREACI√ìN DEL POST EN WORDPRESS (Editor Gutenberg):
   a) Navega a "A√±adir nueva entrada"
   b) Inserta el t√≠tulo en el campo correspondiente
   
   c) Inserta la descripci√≥n usando el Editor de C√≥digo de Gutenberg:
      - Hace clic en "Opciones" (tres puntos)
      - Selecciona "Editor de c√≥digo"
      - Pega el contenido HTML formateado
      - Sale del editor de c√≥digo
   
   d) Inserta la frase clave en Yoast SEO
   
   e) Inserta la meta descripci√≥n en Yoast SEO
   
   f) Configura las categor√≠as:
      - Abre el panel de categor√≠as
      - Busca cada categor√≠a en la lista
      - Si existe: la selecciona (con JavaScript para evitar errores)
      - Si NO existe:
        * Hace clic en "A√±adir categor√≠a"
        * Escribe el nombre en el campo
        * Hace clic en "A√±adir nueva categor√≠a" (bot√≥n azul)
        * La selecciona autom√°ticamente

3.3 GUARDADO:
   - Hace clic en "Guardar borrador"
   - Verifica que se guard√≥ correctamente
   - Si falla, intenta con m√©todo alternativo (Ctrl+S)
   - Muestra mensaje de √©xito o error

FASE 4: FINALIZACI√ìN
---------------------
9. Repite FASE 3 para cada archivo Word encontrado
10. Muestra resumen final:
    - Total de archivos procesados
    - Archivos guardados exitosamente
    - Archivos fallidos (si los hay)
11. Cierra el navegador autom√°ticamente

================================================================================
6. ¬øC√ìMO USAR EL SCRIPT?
================================================================================

PASO 1: PREPARAR LOS DOCUMENTOS WORD
-------------------------------------
- Crea tus documentos Word con el formato descrito arriba
- Gu√°rdalos en la carpeta configurada en el script
- Aseg√∫rate de que tengan extensi√≥n .docx

PASO 2: CONFIGURAR EL SCRIPT
-----------------------------
- Abre el archivo Corner.py con un editor de texto
- Modifica las l√≠neas 17-20 con tus datos
- Guarda los cambios

PASO 3: EJECUTAR EL SCRIPT
---------------------------
Opci√≥n A - Desde la terminal:
    1. Abre la terminal/PowerShell
    2. Navega a la carpeta del script:
       cd "C:\Users\Jonathan JD\Desktop\pink\Robert\CodigoCorner 1"
    3. Ejecuta:
       python Corner.py

Opci√≥n B - Desde el editor:
    1. Abre el archivo en VS Code u otro editor
    2. Presiona F5 o clic en "Run"

PASO 4: OBSERVAR EL PROCESO
----------------------------
- El navegador Chrome se abrir√° autom√°ticamente
- Ver√°s c√≥mo se van procesando los archivos
- En la consola ver√°s mensajes de progreso:
  [INFO] - Informaci√≥n general
  [OK] - Operaci√≥n exitosa
  [WARNING] - Advertencia (no cr√≠tico)
  [ERROR] - Error (requiere atenci√≥n)
  [DEBUG] - Informaci√≥n de depuraci√≥n
  [SUCCESS] - Proceso completado exitosamente

PASO 5: VERIFICAR RESULTADOS
-----------------------------
- Al finalizar, ver√°s un resumen en la consola
- Ve a tu WordPress ‚Üí Entradas ‚Üí Borradores
- Verifica que los posts se crearon correctamente
- Revisa y publica cuando est√©s listo

================================================================================
7. MENSAJES DEL SCRIPT - QU√â SIGNIFICAN
================================================================================

[INFO] Se encontraron 5 archivos Word
    ‚Üí El script encontr√≥ 5 documentos .docx para procesar

[INFO] Procesando: Receta_Vino.docx
    ‚Üí Est√° procesando ese archivo espec√≠fico

[INFO] T√≠tulo: Gu√≠a de Vinos Espa√±oles
    ‚Üí Extrajo el t√≠tulo correctamente

[WARNING] Descripci√≥n: [VAC√çA - REVISAR DOCUMENTO]
    ‚Üí No encontr√≥ la descripci√≥n, revisa el formato del Word

[DEBUG] Total de categor√≠as detectadas: 2
    ‚Üí Encontr√≥ 2 categor√≠as en el documento

[DEBUG] Categor√≠as a procesar: Vinos, Gastronom√≠a
    ‚Üí Lista completa de categor√≠as detectadas

[OK] Categor√≠a seleccionada: Vinos
    ‚Üí Seleccion√≥ una categor√≠a existente

[INFO] Intentando crear nueva categor√≠a: 'Enoturismo'
    ‚Üí Va a crear una categor√≠a nueva porque no existe

[SUCCESS] Categor√≠a 'Enoturismo' creada exitosamente
    ‚Üí Cre√≥ la nueva categor√≠a correctamente

[OK] Categor√≠a 'Enoturismo' seleccionada despu√©s de crearla
    ‚Üí La nueva categor√≠a fue seleccionada

[SUCCESS] Post 'Gu√≠a de Vinos' guardado como borrador con √©xito!
    ‚Üí El post se guard√≥ correctamente en WordPress

================================================================================
8. DIFERENCIAS CON OTROS SCRIPTS
================================================================================

CORNER.PY vs ESTARDEMODA.PY:
----------------------------

| Caracter√≠stica          | Corner.py (Gutenberg) | EstarDeModa.py (Cl√°sico) |
|------------------------|----------------------|--------------------------|
| Editor WordPress       | Gutenberg (bloques)   | Editor Cl√°sico           |
| Inserci√≥n contenido    | Editor de c√≥digo      | Visual Composer          |
| Creaci√≥n categor√≠as    | Panel lateral         | Formulario inferior      |
| Etiquetas             | No soporta            | S√≠ soporta               |
| Selectores CSS        | Modernos (Gutenberg)  | Tradicionales (Cl√°sico)  |

CU√ÅNDO USAR CORNER.PY:
----------------------
‚úì Tu WordPress usa el editor Gutenberg (bloques)
‚úì Ves "A√±adir bloque" cuando creas posts
‚úì La interfaz es moderna con bloques arrastrables

CU√ÅNDO USAR ESTARDEMODA.PY:
----------------------------
‚úì Tu WordPress usa el editor cl√°sico
‚úì Usas Visual Composer
‚úì Ves una interfaz tradicional tipo documento

================================================================================
9. RESOLUCI√ìN DE PROBLEMAS
================================================================================

PROBLEMA: "ModuleNotFoundError: No module named 'docx'"
SOLUCI√ìN: Instalar el m√≥dulo python-docx
    pip install python-docx

PROBLEMA: "ModuleNotFoundError: No module named 'selenium'"
SOLUCI√ìN: Instalar selenium
    pip install selenium

PROBLEMA: "Unable to locate or obtain driver"
SOLUCI√ìN: El script usa Chrome autom√°ticamente. Aseg√∫rate de tener Chrome instalado.

PROBLEMA: T√≠tulo o descripci√≥n vac√≠os
SOLUCI√ìN: Verifica que tu documento Word tenga exactamente:
    - "Titulo de la ficha" (o variaciones)
    - "Descripci√≥n:" (o variaciones)

PROBLEMA: No encuentra el "Editor de c√≥digo"
SOLUCI√ìN:
    1. Verifica que uses WordPress con Gutenberg
    2. Si usas editor cl√°sico, usa EstarDeModa.py en su lugar
    3. Actualiza WordPress a la √∫ltima versi√≥n

PROBLEMA: Categor√≠as no se crean
SOLUCI√ìN:
    1. Verifica que el usuario tenga permisos para crear categor√≠as
    2. Revisa que est√©n separadas por comas
    3. Mira los mensajes [DEBUG] para ver qu√© detect√≥

PROBLEMA: "No se encontr√≥ el bot√≥n de opciones"
SOLUCI√ìN:
    1. Puede ser que WordPress est√© en espa√±ol/ingl√©s
    2. El script busca ambas versiones autom√°ticamente
    3. Verifica que la p√°gina se haya cargado completamente

PROBLEMA: Error "element click intercepted"
SOLUCI√ìN: Ya est√° resuelto con JavaScript click autom√°tico

PROBLEMA: La descripci√≥n no aparece formateada
SOLUCI√ìN: 
    1. Verifica que el contenido HTML se insert√≥ correctamente
    2. El script usa el editor de c√≥digo de Gutenberg
    3. Revisa que el bloque sea de tipo "HTML personalizado"

================================================================================
10. CARACTER√çSTICAS AVANZADAS
================================================================================

PROCESAMIENTO EN LOTE:
----------------------
Procesa TODOS los archivos .docx de la carpeta autom√°ticamente.

RECUPERACI√ìN DE ERRORES:
------------------------
Si un archivo falla, contin√∫a con los siguientes.
Incluye mecanismo de reinicio del navegador si hay errores cr√≠ticos.

JAVASCRIPT CLICK:
-----------------
Usa JavaScript para hacer clic en checkboxes de categor√≠as,
evitando que la barra de administraci√≥n bloquee las acciones.

CREACI√ìN AUTOM√ÅTICA DE CATEGOR√çAS:
----------------------------------
Proceso completo:
1. Busca la categor√≠a por texto exacto
2. Si no encuentra, busca por coincidencia parcial
3. Si a√∫n no encuentra, crea la categor√≠a nueva
4. Selecciona la categor√≠a autom√°ticamente

DETECCI√ìN FLEXIBLE:
------------------
Busca t√≠tulos y descripciones con m√∫ltiples variaciones:
- "Titulo de la ficha", "T√≠tulo de la ficha"
- "Descripci√≥n:", "Descripcion:"
- Con o sin dos puntos
- En may√∫sculas o min√∫sculas

FORMATO M√öLTIPLE:
-----------------
Soporta texto con varios formatos simult√°neos:
<strong><em><u>Texto en negrita, cursiva y subrayado</u></em></strong>

DIVISI√ìN DE CATEGOR√çAS:
-----------------------
Categor√≠as: Vinos, Gastronom√≠a, Recetas
        ‚Üì           ‚Üì           ‚Üì
   ["Vinos", "Gastronom√≠a", "Recetas"]

AGRUPACI√ìN DE LISTAS HTML:
---------------------------
Listas consecutivas se agrupan correctamente:
<ul>
  <li>Item 1</li>
  <li>Item 2</li>
  <li>Item 3</li>
</ul>

================================================================================
11. MANTENIMIENTO Y ACTUALIZACIONES
================================================================================

CAMBIAR CREDENCIALES:
---------------------
Edita las l√≠neas 17-20 del script con las nuevas credenciales.

CAMBIAR CARPETA DE ARCHIVOS:
----------------------------
Modifica la l√≠nea 20 (carpeta_word) con la nueva ruta.

ACTUALIZAR PYTHON:
------------------
Si actualizas Python, reinstala los m√≥dulos:
    pip install --upgrade python-docx selenium

VER VERSI√ìN DEL SCRIPT:
-----------------------
L√≠nea 2 del script o l√≠nea 5 de este documento.

CAMBIAR TIMEOUT:
----------------
L√≠nea 629: wait = WebDriverWait(driver, 30)
El 30 son segundos. Aumenta si tu conexi√≥n es lenta.

================================================================================
12. ESTRUCTURA INTERNA DEL SCRIPT
================================================================================

FUNCIONES PRINCIPALES:
----------------------

1. obtener_archivos_word(carpeta)
   ‚Üí Lista todos los .docx de la carpeta

2. extraer_titulo(doc)
   ‚Üí Extrae el t√≠tulo del documento Word

3. extraer_descripcion_con_formato(doc)
   ‚Üí Extrae y convierte la descripci√≥n a HTML

4. frase_clave(doc)
   ‚Üí Extrae la frase clave objetivo

5. titulo_seo(doc)
   ‚Üí Extrae el t√≠tulo SEO

6. meta_description(doc)
   ‚Üí Extrae la meta descripci√≥n

7. leer_categorias(doc)
   ‚Üí Extrae categor√≠as y las divide por comas

8. crear_nueva_categoria(driver, wait, nombre_categoria)
   ‚Üí Crea una nueva categor√≠a en WordPress

9. guardar_borrador(driver, wait)
   ‚Üí Guarda el post como borrador

10. procesar_archivo(archivo_word, driver, wait)
    ‚Üí Funci√≥n principal que procesa un archivo completo

11. main()
    ‚Üí Funci√≥n que coordina todo el proceso

================================================================================
13. LIMITACIONES Y CONSIDERACIONES
================================================================================

‚úì Solo procesa archivos .docx (no .doc antiguos)
‚úì Requiere conexi√≥n a internet estable
‚úì Requiere permisos de administrador en WordPress
‚úì El navegador debe permanecer abierto durante el proceso
‚úì No cierres la ventana del navegador manualmente
‚úì Los archivos Word deben seguir el formato especificado
‚úì Crea BORRADORES, no publica autom√°ticamente (por seguridad)
‚úì Requiere WordPress con editor Gutenberg activado
‚úì No soporta etiquetas (solo categor√≠as)
‚úì No soporta im√°genes (solo texto)

================================================================================
14. BUENAS PR√ÅCTICAS
================================================================================

ANTES DE EJECUTAR:
------------------
1. Haz backup de tu base de datos WordPress
2. Prueba con 1-2 archivos primero
3. Verifica que el formato Word sea consistente
4. Aseg√∫rate de tener buena conexi√≥n a internet

DURANTE LA EJECUCI√ìN:
---------------------
1. No cierres el navegador manualmente
2. No interrumpas el script (Ctrl+C solo en emergencia)
3. Observa los mensajes en la consola
4. Si ves muchos [ERROR], det√©n y revisa

DESPU√âS DE EJECUTAR:
--------------------
1. Revisa los borradores en WordPress
2. Verifica que el formato se preserv√≥
3. Comprueba que las categor√≠as est√°n correctas
4. Publica solo despu√©s de revisar

ORGANIZACI√ìN:
-------------
1. Mant√©n los archivos Word en carpetas separadas
2. Usa nombres descriptivos para los archivos
3. Procesa lotes peque√±os (5-10 archivos m√°ximo)
4. Guarda un log del proceso para referencia

================================================================================
15. PREGUNTAS FRECUENTES (FAQ)
================================================================================

P: ¬øPuedo usar el script sin modificar WordPress?
R: S√≠, no modifica configuraciones, solo crea contenido.

P: ¬øSe pueden procesar 100 archivos a la vez?
R: T√©cnicamente s√≠, pero es mejor hacerlo en lotes de 10-20.

P: ¬øQu√© pasa si se cae internet durante el proceso?
R: El script fallar√°. Vuelve a ejecutarlo, solo procesar√° los que faltaron.

P: ¬øSe pueden subir im√°genes autom√°ticamente?
R: No, esta versi√≥n solo maneja texto formateado.

P: ¬øPuedo programar el script para que se ejecute solo?
R: S√≠, usando herramientas como Windows Task Scheduler.

P: ¬øEl script publica autom√°ticamente?
R: No, solo crea borradores por seguridad.

P: ¬øFunciona en Mac o Linux?
R: S√≠, solo ajusta las rutas de carpetas (usar / en lugar de \).

P: ¬øPuedo procesar archivos de Google Docs?
R: Primero desc√°rgalos como .docx, luego s√≠.

P: ¬øQu√© pasa con los borradores duplicados?
R: WordPress los tratar√° como posts separados. Elimina los duplicados manualmente.

P: ¬øEs seguro guardar las credenciales en el script?
R: Para uso personal s√≠, pero nunca compartas el archivo con otros.

================================================================================
16. SOPORTE Y MEJORAS FUTURAS
================================================================================

POSIBLES MEJORAS:
-----------------
‚ñ° Soporte para im√°genes
‚ñ° Soporte para videos embebidos
‚ñ° Publicaci√≥n autom√°tica (opcional)
‚ñ° Programaci√≥n de posts
‚ñ° Soporte para etiquetas
‚ñ° Interfaz gr√°fica (GUI)
‚ñ° Logs en archivo separado
‚ñ° Configuraci√≥n desde archivo externo
‚ñ° Soporte para m√∫ltiples WordPress
‚ñ° Verificaci√≥n de enlaces rotos

SI ENCUENTRAS UN ERROR:
-----------------------
1. Anota el mensaje de error completo
2. Verifica que el documento Word tenga el formato correcto
3. Revisa los requisitos previos
4. Consulta la secci√≥n "Resoluci√≥n de Problemas"
5. Verifica que WordPress y los plugins est√©n actualizados

================================================================================
17. AGRADECIMIENTOS Y CR√âDITOS
================================================================================

TECNOLOG√çAS UTILIZADAS:
-----------------------
- Python 3.9+
- Selenium WebDriver
- python-docx
- Google Chrome / ChromeDriver
- WordPress + Gutenberg

LIBRER√çAS OPEN SOURCE:
----------------------
- Selenium: Automatizaci√≥n de navegadores web
- python-docx: Lectura de documentos Microsoft Word
- Chrome DevTools: Inspecci√≥n de elementos web

================================================================================
18. INFORMACI√ìN LEGAL
================================================================================

USO RESPONSABLE:
----------------
- Este script es para uso personal/profesional leg√≠timo
- No uses para spam o contenido no autorizado
- Respeta los t√©rminos de servicio de tu hosting
- Mant√©n actualizados tus sistemas de seguridad
- Protege tus credenciales de acceso

DESCARGO DE RESPONSABILIDAD:
---------------------------
- El script se proporciona "tal cual"
- Usa bajo tu propia responsabilidad
- Haz backups antes de usar
- Prueba en entorno de desarrollo primero
- No nos hacemos responsables de p√©rdida de datos

================================================================================
                       ¬°√âXITO EN TU AUTOMATIZACI√ìN!
================================================================================

Este script te ahorrar√° horas de trabajo manual. √ösalo sabiamente y siempre
revisa los borradores antes de publicar. La automatizaci√≥n es una herramienta
poderosa, pero la revisi√≥n humana sigue siendo esencial para contenido de calidad.

¬°Feliz automatizaci√≥n! üöÄ

================================================================================
                            FIN DE LA DOCUMENTACI√ìN
================================================================================

